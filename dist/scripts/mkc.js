!function e(t,i,s){function n(r,h){if(!i[r]){if(!t[r]){var o="function"==typeof require&&require;if(!h&&o)return o(r,!0);if(a)return a(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var l=i[r]={exports:{}};t[r][0].call(l.exports,function(e){var i=t[r][1][e];return n(i?i:e)},l,l.exports,e,t,i,s)}return i[r].exports}for(var a="function"==typeof require&&require,r=0;r<s.length;r++)n(s[r]);return n}({1:[function(e,t,i){var s=e("./modules/main-app.js");s.init()},{"./modules/main-app.js":4}],2:[function(e,t,i){!function(e){"function"==typeof define&&define.amd?define(e):"undefined"!=typeof t&&t.exports?t.exports=e():window.pym=e.call(this)}(function(){var e="xPYMx",t={},i=function(e){var t=new RegExp("[\\?&]"+e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")+"=([^&#]*)"),i=t.exec(location.search);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))},s=function(e,t){if("*"===t.xdomain||e.origin.match(new RegExp(t.xdomain+"$")))return!0},n=function(t,i,s){var n=["pym",t,i,s];return n.join(e)},a=function(t){var i=["pym",t,"(\\S+)","(.+)"];return new RegExp("^"+i.join(e)+"$")},r=function(){for(var e=document.querySelectorAll("[data-pym-src]:not([data-pym-auto-initialized])"),i=e.length,s=0;s<i;++s){var n=e[s];n.setAttribute("data-pym-auto-initialized",""),""===n.id&&(n.id="pym-"+s);var a=n.getAttribute("data-pym-src"),r=n.getAttribute("data-pym-xdomain"),h={};r&&(h.xdomain=r),new t.Parent(n.id,a,h)}};return t.Parent=function(e,t,i){this.id=e,this.url=t,this.el=document.getElementById(e),this.iframe=null,this.settings={xdomain:"*"},this.messageRegex=a(this.id),this.messageHandlers={},i=i||{},this._constructIframe=function(){var e=this.el.offsetWidth.toString();this.iframe=document.createElement("iframe");var t="",i=this.url.indexOf("#");i>-1&&(t=this.url.substring(i,this.url.length),this.url=this.url.substring(0,i)),this.url.indexOf("?")<0?this.url+="?":this.url+="&",this.iframe.src=this.url+"initialWidth="+e+"&childId="+this.id+"&parentUrl="+encodeURIComponent(window.location.href)+t,this.iframe.setAttribute("width","100%"),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("marginheight","0"),this.iframe.setAttribute("frameborder","0"),this.el.appendChild(this.iframe),window.addEventListener("resize",this._onResize)},this._onResize=function(){this.sendWidth()}.bind(this),this._fire=function(e,t){if(e in this.messageHandlers)for(var i=0;i<this.messageHandlers[e].length;i++)this.messageHandlers[e][i].call(this,t)},this.remove=function(){window.removeEventListener("message",this._processMessage),window.removeEventListener("resize",this._onResize),this.el.removeChild(this.iframe)},this._processMessage=function(e){if(s(e,this.settings)&&"string"==typeof e.data){var t=e.data.match(this.messageRegex);if(!t||3!==t.length)return!1;var i=t[1],n=t[2];this._fire(i,n)}}.bind(this),this._onHeightMessage=function(e){var t=parseInt(e);this.iframe.setAttribute("height",t+"px")},this._onNavigateToMessage=function(e){document.location.href=e},this.onMessage=function(e,t){e in this.messageHandlers||(this.messageHandlers[e]=[]),this.messageHandlers[e].push(t)},this.sendMessage=function(e,t){this.el.getElementsByTagName("iframe")[0].contentWindow.postMessage(n(this.id,e,t),"*")},this.sendWidth=function(){var e=this.el.offsetWidth.toString();this.sendMessage("width",e)};for(var r in i)this.settings[r]=i[r];return this.onMessage("height",this._onHeightMessage),this.onMessage("navigateTo",this._onNavigateToMessage),window.addEventListener("message",this._processMessage,!1),this._constructIframe(),this},t.Child=function(t){this.parentWidth=null,this.id=null,this.parentUrl=null,this.settings={renderCallback:null,xdomain:"*",polling:0},this.messageRegex=null,this.messageHandlers={},t=t||{},this.onMessage=function(e,t){e in this.messageHandlers||(this.messageHandlers[e]=[]),this.messageHandlers[e].push(t)},this._fire=function(e,t){if(e in this.messageHandlers)for(var i=0;i<this.messageHandlers[e].length;i++)this.messageHandlers[e][i].call(this,t)},this._processMessage=function(e){if(s(e,this.settings)&&"string"==typeof e.data){var t=e.data.match(this.messageRegex);if(t&&3===t.length){var i=t[1],n=t[2];this._fire(i,n)}}}.bind(this),this._onWidthMessage=function(e){var t=parseInt(e);t!==this.parentWidth&&(this.parentWidth=t,this.settings.renderCallback&&this.settings.renderCallback(t),this.sendHeight())},this.sendMessage=function(e,t){window.parent.postMessage(n(this.id,e,t),"*")},this.sendHeight=function(){var e=document.getElementsByTagName("body")[0].offsetHeight.toString();this.sendMessage("height",e)}.bind(this),this.scrollParentTo=function(e){this.sendMessage("navigateTo","#"+e)},this.navigateParentTo=function(e){this.sendMessage("navigateTo",e)},this.id=i("childId")||t.id,this.messageRegex=new RegExp("^pym"+e+this.id+e+"(\\S+)"+e+"(.+)$");var a=parseInt(i("initialWidth"));this.parentUrl=i("parentUrl"),this.onMessage("width",this._onWidthMessage);for(var r in t)this.settings[r]=t[r];return window.addEventListener("message",this._processMessage,!1),this.settings.renderCallback&&this.settings.renderCallback(a),this.sendHeight(),this.settings.polling&&window.setInterval(this.sendHeight,this.settings.polling),this},r(),t})},{}],3:[function(e,t,i){t.exports=function(){function e(){d=!0,this.removeEventListener("DOMAttrModified",e,!1)}function t(e){return e.replace(h,function(e,t){return t.toUpperCase()})}function i(){var e={};return a.call(this.attributes,function(i){(n=i.name.match(r))&&(e[t(n[1])]=i.value)}),e}function s(e,t,i){Object.defineProperty?Object.defineProperty(e,t,{get:i}):e.__defineGetter__(t,i)}var n,a=[].forEach,r=/^data-(.+)/,h=/\-([a-z])/gi,o=document.createElement("div"),d=!1;void 0==o.dataset&&(o.addEventListener("DOMAttrModified",e,!1),o.setAttribute("foo","bar"),s(Element.prototype,"dataset",d?function(){return this._datasetCache||(this._datasetCache=i.call(this)),this._datasetCache}:i),document.addEventListener("DOMAttrModified",function(e){delete e.target._datasetCache},!1))}()},{}],4:[function(e,t,i){t.exports=function(){function t(e,t){"undefined"==typeof e&&(e="");var i,s=function(e,t){return e=parseInt(e,10).toString(16),t<e.length?e.slice(e.length-t):t>e.length?Array(1+(t-e.length)).join("0")+e:e};return this.php_js||(this.php_js={}),this.php_js.uniqidSeed||(this.php_js.uniqidSeed=Math.floor(123456789*Math.random())),this.php_js.uniqidSeed++,i=e,i+=s(parseInt((new Date).getTime()/1e3,10),8),i+=s(this.php_js.uniqidSeed,5),t&&(i+=(10*Math.random()).toFixed(8).toString()),i}function i(e){var t="https://cartes-elections.makina-corpus.net/",i={"2015-cantons-et-candidats":{url:"departementales-2015/app/public/"},"2015-resultats-departementales":{url:"departementales-2015/app/public/departement.html"}},s=i[e];return s&&s.url?t+s.url:e.indexOf("_")===-1?t+e+"/":t+e.split("_")[0]+"/"+e.split("_")[1]+".html"}function s(){return document.querySelectorAll(r.phSelector)}function n(e){var s=t("mkc-");e.id=s;var n=e.dataset.source,a=new h.Parent(s,i(n),{});a.onMessage("event",function(t){"ready"===t&&(a.sendMessage("data",JSON.stringify(e.dataset)),this.iframe&&this.iframe.setAttribute&&this.iframe.setAttribute("allowfullscreen",""))})}function a(){var e=s();[].forEach.call(e,n)}var r={phSelector:".mkc-placeholder"};e("./dataset-polyfill.js");var h=e("pym.js");return{init:a}}()},{"./dataset-polyfill.js":3,"pym.js":2}]},{},[1]);
//# sourceMappingURL=mkc.js.map
